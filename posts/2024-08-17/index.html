<!doctype html><html lang=ja-jp><head><link rel=preload href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><meta charset=utf-8><title>Aterm WG1800HP2のrootを取る | Xrzheaven</title><link rel=canonical href=https://xrzhev.com/posts/2024-08-17/><meta name=description content="いろいろやっていき"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:url" content="https://xrzhev.com/posts/2024-08-17/"><meta property="og:site_name" content="Xrzheaven"><meta property="og:title" content="Aterm WG1800HP2のrootを取る"><meta property="og:description" content="ハードウェアでガチャガチャ遊びたくなった！！ので中古の安いwifiルーターでrootシェルを取ってファイルシステムを覗いてみる"><meta property="og:locale" content="ja_jp"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-08-17T00:00:00+09:00"><meta property="article:modified_time" content="2026-01-21T19:47:14+09:00"><meta property="article:tag" content="備忘"><meta property="article:tag" content="Wifi"><meta property="article:tag" content="ルーター"><meta property="article:tag" content="分解"><meta property="article:tag" content="殺意駆動コース"><meta property="og:image" content="https://xrzhev.com/posts/2024-08-17/feature-ogp.webp"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://xrzhev.com/posts/2024-08-17/feature-ogp.webp"><meta name=twitter:title content="Aterm WG1800HP2のrootを取る"><meta name=twitter:description content="ハードウェアでガチャガチャ遊びたくなった！！ので中古の安いwifiルーターでrootシェルを取ってファイルシステムを覗いてみる"><link rel=stylesheet href=https://xrzhev.com/css/styles.1a49c87f346da479e979fd2bcaf51e16bd7f0c239640675e7b34e5680a037f7d6ac11ad270e91c1201d2caf30595569b4003606b59c01aff811fba3504d5fe2a.css integrity="sha512-GknIfzRtpHnpef0ryvUeFr1/DCOWQGdeezTlaAoDf31qwRrScOkcEgHSyvMFlVabQANga1nAGv+BH7o1BNX+Kg=="><link rel=icon href=/images/favicon.svg type=image/svg+xml></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/about/>About</a></li><li><a href=/posts/>Posts</a></li><li><a href=/categories/>Categories</a></li><li><a href=/tags/>Tags</a></li><li><a href=/index.xml>RSS</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://xrzhev.com/posts/2022-09-22/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=https://xrzhev.com/posts/2025-01-21/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fxrzhev.com%2fposts%2f2024-08-17%2f&text=Aterm%20WG1800HP2%e3%81%aeroot%e3%82%92%e5%8f%96%e3%82%8b" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="https://b.hatena.ne.jp/entry/panel/?url=https%3a%2f%2fxrzhev.com%2fposts%2f2024-08-17%2f#bbutton" aria-label=Hatena><i class="fab fa-hatena" aria-hidden=true></i></a></li><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fxrzhev.com%2fposts%2f2024-08-17%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#攻略対象>攻略対象</a></li><li><a href=#ガワ調査>ガワ調査</a></li><li><a href=#シェルアクセス>シェルアクセス</a></li><li><a href=#root奪取>root奪取</a></li><li><a href=#ファイルシステム探訪>ファイルシステム探訪</a></li><li><a href=#おわりに>おわりに</a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Aterm WG1800HP2のrootを取る</h1><div class=meta><div class=postdate>投稿日: <time datetime="2024-08-17 00:00:00 +0900 +0900" itemprop=datePublished>2024-08-17 00:00:00</time>
(最終更新日: <time datetime="2026-01-21 19:47:14 +0900 +0900" itemprop=dateModified>2026-01-21 19:47:14</time>)</div><div class=article-category><i class="fas fa-archive"></i>
<a class=category-link href=/categories/%E3%83%8F%E3%83%BC%E3%83%89%E3%82%A6%E3%82%A7%E3%82%A2>ハードウェア</a></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/%E5%82%99%E5%BF%98 rel=tag>備忘</a>
,
<a class=tag-link href=/tags/wifi rel=tag>wifi</a>
,
<a class=tag-link href=/tags/%E3%83%AB%E3%83%BC%E3%82%BF%E3%83%BC rel=tag>ルーター</a>
,
<a class=tag-link href=/tags/%E5%88%86%E8%A7%A3 rel=tag>分解</a>
,
<a class=tag-link href=/tags/%E6%AE%BA%E6%84%8F%E9%A7%86%E5%8B%95%E3%82%B3%E3%83%BC%E3%82%B9 rel=tag>殺意駆動コース</a></div></div></header><div class=content itemprop=articleBody><p>ハードウェアでガチャガチャ遊びたくなった！！ので中古の安いwifiルーターでrootシェルを取ってファイルシステムを覗いてみる</p><h2 id=攻略対象>攻略対象</h2><ul><li>NEC Aterm WG1800HP2<ul><li><a href=https://www.aterm.jp/product/atermstation/product/warpstar/wg1800hp2/>https://www.aterm.jp/product/atermstation/product/warpstar/wg1800hp2/</a></li><li>2014/10/9　発売</li><li>現在はサポート終了済</li></ul></li></ul><h2 id=ガワ調査>ガワ調査</h2><ul><li>ルーターなのでLANポートがついている<ul><li>ここから接続できる？</li></ul></li><li>TCP/23でtelnetが動作中<ul><li>Google検索したところパスワードは公開されていなさそうだった</li><li>とりあえず時間の無駄そうなので別の方法で攻略する</li></ul></li><li>基盤チェック</li></ul><p><picture><source srcset=/posts/2024-08-17/img/1_hu_e9372659cbb4bf2b.webp type=image/webp><img src=/posts/2024-08-17/img/1.png width=728 height=868 alt=基板俯瞰 loading=lazy></picture></p><ul><li>ルーターは<strong>Unix/Linux</strong>で動いていることが多い<ul><li>組み込みのUnix/Linux</li></ul></li><li>テスト用にUARTのポートがあることが多い<ul><li>見分け方<ul><li>4~5個のテストピンやテストパッドが基盤に実装されている</li></ul></li></ul></li></ul><blockquote><p>Tips: UARTについて</p><p>UART (Universal Asynchronous Receiver Transmitter)<br>最低3本の線でシリアル通信ができる通信規格<br>GNDなくても動くケースが多いが、ノイズ対策の観点から使うべき</p><ul><li>Tx: 送信</li><li>Rx: 受信</li><li>GND: 基準電圧</li></ul><p><picture><source srcset=/posts/2024-08-17/img/2_hu_eabc1ae0f49bb7ab.webp type=image/webp><img src=/posts/2024-08-17/img/2.png width=801 height=263 alt=UART概略 loading=lazy></picture></p><p><strong>クロックの指定が結線上に存在していないため、ボーレートをデバイス側で指定する必要がある</strong></p></blockquote><ul><li>基盤を眺めると怪しいテストポートがある</li></ul><p><picture><source srcset=/posts/2024-08-17/img/3_hu_172428146ec8cbeb.webp type=image/webp><img src=/posts/2024-08-17/img/3.png width=1106 height=602 alt loading=lazy></picture></p><ul><li><p>テストポートが5つの場合は以下のものが想定される</p><ul><li>VCC (3.3V or 5V)</li><li>GND</li><li>Rx</li><li>Tx</li><li>多目的使用 or N.C.</li></ul></li><li><p>テスターを利用して探していく</p></li><li><p>各ポートの調査のコツ</p><ul><li>最初にVCCとGNDを探す<ul><li>テスターを利用して3.3V / 5Vを拾えたら残りをguessする</li></ul></li><li>Txのポートは伝送時に電圧がHighになる</li><li>Rxのポートは大きく動かない</li><li>スペクトラムアナライザがあると便利<ul><li>UARTの通信を拾うくらいならラズパイピコで作れるので作ることをオススメ<ul><li><a href=https://oscilloscope.fhdm.xyz/>https://oscilloscope.fhdm.xyz/</a></li></ul></li></ul></li></ul></li><li><p>調査の結果、こんな感じに</p></li></ul><p><picture><source srcset=/posts/2024-08-17/img/4_hu_250654259a8d9060.webp type=image/webp><img src=/posts/2024-08-17/img/4.png width=1124 height=756 alt loading=lazy></picture></p><ul><li>ポートにはんだ付け</li></ul><p><picture><source srcset=/posts/2024-08-17/img/5_hu_d1c397b70d062b5d.webp type=image/webp><img src=/posts/2024-08-17/img/5.png width=820 height=591 alt loading=lazy></picture></p><ul><li><p>GNDのはんだがあまりにも汚い</p><ul><li>みんなはフラックスをちゃんと&mldr;使おうね！</li></ul></li><li><p>BusPirateにTx, Rx, GNDを接続</p><ul><li>注意: Tx-Rx, Rx-Txとデバイス間でTx, Rxの接続は逆になる</li><li>なぜか手元のFTDIチップのシリアル変換ボードで動作しなかった<ul><li>いまだに理由がわかってない<ul><li>⇒ (追記) <strong>FTDIチップが焼けてぶっ壊れてた、アホです</strong></li></ul></li><li>家に転がってたBus Pirateで対応</li></ul></li></ul></li></ul><p><picture><source srcset=/posts/2024-08-17/img/6_hu_58c9c934e4f86d9c.webp type=image/webp><img src=/posts/2024-08-17/img/6.png width=735 height=414 alt loading=lazy></picture></p><h2 id=シェルアクセス>シェルアクセス</h2><ul><li>ターミナルを開いていろいろ見ていく</li></ul><p><picture><source srcset=/posts/2024-08-17/img/7_hu_6bdc6155779cb4f7.webp type=image/webp><img src=/posts/2024-08-17/img/7.png width=1012 height=677 alt loading=lazy></picture></p><ul><li>シェルのログイン画面が見えるが、ID/パスワードがわからない<ul><li>ブルートフォースは現実的ではない</li></ul></li></ul><p><picture><source srcset=/posts/2024-08-17/img/8_hu_2593c62cc511639b.webp type=image/webp><img src=/posts/2024-08-17/img/8.png width=916 height=616 alt loading=lazy></picture></p><h2 id=root奪取>root奪取</h2><ul><li>シングルユーザーモードで立ち上げる必要がある<ul><li>ブートローダーであるUbootをどうにかする必要がある</li><li>ルーター起動中に<code>Ctrl-C</code>を連打することでシングルユーザーモードに入れる</li></ul></li></ul><p><picture><source srcset=/posts/2024-08-17/img/9_hu_3d964d0c11317f21.webp type=image/webp><img src=/posts/2024-08-17/img/9.png width=918 height=608 alt loading=lazy></picture></p><h2 id=ファイルシステム探訪>ファイルシステム探訪</h2><ul><li>ルーターのWebアプリケーションして動作するCGIを発見</li></ul><p><picture><source srcset=/posts/2024-08-17/img/10_hu_8ebaec9e921f8a8e.webp type=image/webp><img src=/posts/2024-08-17/img/10.png width=713 height=527 alt loading=lazy></picture></p><ul><li>シングルユーザーモードなのでネットワーク環境がない<ul><li>どうやって持ち帰るか</li><li>USBが生えているのでこいつでUSBをマウントできるか試す</li></ul></li></ul><p><picture><source srcset=/posts/2024-08-17/img/11_hu_bb7bd36b4e17f92c.webp type=image/webp><img src=/posts/2024-08-17/img/11.png width=902 height=507 alt loading=lazy></picture></p><ul><li>USBメモリを刺すとマスストレージとして認識<ul><li>マウントしたら使えそう</li></ul></li></ul><p><picture><source srcset=/posts/2024-08-17/img/12_hu_fe570612ae77d39d.webp type=image/webp><img src=/posts/2024-08-17/img/12.png width=911 height=558 alt loading=lazy></picture></p><ul><li>Mountコマンドがない</li></ul><p><picture><source srcset=/posts/2024-08-17/img/13_hu_845587cf2e47d9cb.webp type=image/webp><img src=/posts/2024-08-17/img/13.png width=953 height=544 alt loading=lazy></picture></p><ul><li><p>使えそうなバイナリを調査</p><ul><li>mount_ffs</li><li>mount_kernfs</li><li>mount_msdos</li><li>mount_procfs</li><li>mount_tinyfs<ul><li>→ <code>mount_msdos</code>, <code>mount_tinyfs</code>が使えそう</li></ul></li></ul></li><li><p>USBを刺し、それをmsdosでフォーマット、mount_msdosでマウントする</p></li></ul><p><picture><source srcset=/posts/2024-08-17/img/14_hu_3fd4b98582328dc0.webp type=image/webp><img src=/posts/2024-08-17/img/14.png width=793 height=287 alt loading=lazy></picture><br><picture><source srcset=/posts/2024-08-17/img/15_hu_53c7cc41b130bc5f.webp type=image/webp><img src=/posts/2024-08-17/img/15.png width=1186 height=353 alt loading=lazy></picture></p><ul><li>あとはddとかで好き勝手ファイルをコピーしまくるだけ<ul><li>お持ち帰りしたファイルを思う存分味わおう!</li></ul></li></ul><p><picture><source srcset=/posts/2024-08-17/img/16_hu_2152bc7f3c614882.webp type=image/webp><img src=/posts/2024-08-17/img/16.png width=794 height=488 alt loading=lazy></picture></p><h2 id=おわりに>おわりに</h2><p>この業界をひたすら走り続けている<a href=https://%E5%A4%A7%E7%A0%B4.net/>大破.net</a>氏に大いなる経緯を表します<br>本記事の一部では大破氏の過去記事を参考にさせていただきました<br>また、分解したwifiルーターの使用については法的な部分から怪しくなるので廃棄済みです<br>そもそも古いwifiルーターをおもちゃとしてメルカリで超格安で買ったので問題ないな！ヨシ！<br>暇があればハードウェアネタも書いていこうと思います</p></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/about/>About</a></li><li><a href=/posts/>Posts</a></li><li><a href=/categories/>Categories</a></li><li><a href=/tags/>Tags</a></li><li><a href=/index.xml>RSS</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#攻略対象>攻略対象</a></li><li><a href=#ガワ調査>ガワ調査</a></li><li><a href=#シェルアクセス>シェルアクセス</a></li><li><a href=#root奪取>root奪取</a></li><li><a href=#ファイルシステム探訪>ファイルシステム探訪</a></li><li><a href=#おわりに>おわりに</a></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fxrzhev.com%2fposts%2f2024-08-17%2f&text=Aterm%20WG1800HP2%e3%81%aeroot%e3%82%92%e5%8f%96%e3%82%8b" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://b.hatena.ne.jp/entry/panel/?url=https%3a%2f%2fxrzhev.com%2fposts%2f2024-08-17%2f#bbutton" aria-label=Hatena><i class="fab fa-hatena fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fxrzhev.com%2fposts%2f2024-08-17%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2026 xrzhev</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/about/>About</a></li><li><a href=/posts/>Posts</a></li><li><a href=/categories/>Categories</a></li><li><a href=/tags/>Tags</a></li><li><a href=/index.xml>RSS</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/all.min.css><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js></script><script src=/js/main.js></script><script src=/js/code-copy.js></script></html>