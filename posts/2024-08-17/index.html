<!doctype html><html lang=ja-jp><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Aterm WG1800HP2のrootを取る | Xrzheaven</title>
<link rel=canonical href=https://xrzhev.com/posts/2024-08-17/><meta name=description content="いろいろやっていき"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="Aterm WG1800HP2のrootを取る"><meta property="og:description" content="ハードウェアでガチャガチャ遊びたくなった！！ので中古の安いwifiルーターでrootシェルを取ってファイルシステムを覗いてみる"><meta property="og:type" content="article"><meta property="og:url" content="https://xrzhev.com/posts/2024-08-17/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-08-17T00:00:00+09:00"><meta property="article:modified_time" content="2025-04-26T09:32:38+09:00"><meta property="og:image" content="https://xrzhev.com/posts/2024-08-17/img/ogp/index.webp"><meta name=twitter:card content="summary"><meta name=twitter:title content="Aterm WG1800HP2のrootを取る"><meta name=twitter:description content="ハードウェアでガチャガチャ遊びたくなった！！ので中古の安いwifiルーターでrootシェルを取ってファイルシステムを覗いてみる"><meta name=twitter:image content="https://xrzhev.com/posts/2024-08-17/img/ogp/index.webp"><link rel=stylesheet href=https://xrzhev.com/css/styles.752d1b94f63350f4fdccbb127540cb597d37de3340624df5b28d34c36f35f7844a36fce9dbab1a3605619eb9d79d695d798f4d1c00d88bb4cd5189ff4069a2d4.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://xrzhev.com/images/favicon.ico><script async src="https://www.googletagmanager.com/gtag/js?id=G-M0JBLYFQ0B"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-M0JBLYFQ0B",{anonymize_ip:!1})}</script></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/categories>Categories</a></li><li><a href=/tags>Tags</a></li><li><a href=/index.xml>Rss</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://xrzhev.com/posts/2022-09-22/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fxrzhev.com%2fposts%2f2024-08-17%2f&text=Aterm%20WG1800HP2%e3%81%aeroot%e3%82%92%e5%8f%96%e3%82%8b" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fxrzhev.com%2fposts%2f2024-08-17%2f&title=Aterm%20WG1800HP2%e3%81%aeroot%e3%82%92%e5%8f%96%e3%82%8b" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Aterm%20WG1800HP2%e3%81%aeroot%e3%82%92%e5%8f%96%e3%82%8b&body=Check out this article: https%3a%2f%2fxrzhev.com%2fposts%2f2024-08-17%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fxrzhev.com%2fposts%2f2024-08-17%2f&title=Aterm%20WG1800HP2%e3%81%aeroot%e3%82%92%e5%8f%96%e3%82%8b" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fxrzhev.com%2fposts%2f2024-08-17%2f&title=Aterm%20WG1800HP2%e3%81%aeroot%e3%82%92%e5%8f%96%e3%82%8b" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fxrzhev.com%2fposts%2f2024-08-17%2f&t=Aterm%20WG1800HP2%e3%81%aeroot%e3%82%92%e5%8f%96%e3%82%8b" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#攻略対象>攻略対象</a></li><li><a href=#ガワ調査>ガワ調査</a></li><li><a href=#シェルアクセス>シェルアクセス</a></li><li><a href=#root奪取>root奪取</a></li><li><a href=#ファイルシステム探訪>ファイルシステム探訪</a></li><li><a href=#おわりに>おわりに</a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Aterm WG1800HP2のrootを取る</h1><div class=meta><div class=postdate>投稿日: <time datetime="2024-08-17 00:00:00 +0900 +0900" itemprop=datePublished>2024-08-17 00:00</time></div><div class=lastmoddate>最終更新日: <time datetime="2025-04-26 09:32:38 +0900 +0900" itemprop=dateModified>2025-04-26 09:32</time></div><div class=article-category><i class="fas fa-archive"></i>
<a class=category-link href=/categories/%E3%83%8F%E3%83%BC%E3%83%89%E3%82%A6%E3%82%A7%E3%82%A2>ハードウェア</a></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/%E5%82%99%E5%BF%98 rel=tag>備忘</a>
,
<a class=tag-link href=/tags/wifi rel=tag>wifi</a>
,
<a class=tag-link href=/tags/%E3%83%AB%E3%83%BC%E3%82%BF%E3%83%BC rel=tag>ルーター</a>
,
<a class=tag-link href=/tags/%E5%88%86%E8%A7%A3 rel=tag>分解</a>
,
<a class=tag-link href=/tags/%E6%AE%BA%E6%84%8F%E9%A7%86%E5%8B%95%E3%82%B3%E3%83%BC%E3%82%B9 rel=tag>殺意駆動コース</a></div></div></header><div class=content itemprop=articleBody><p>ハードウェアでガチャガチャ遊びたくなった！！ので中古の安いwifiルーターでrootシェルを取ってファイルシステムを覗いてみる</p><h2 id=攻略対象>攻略対象</h2><ul><li>NEC Aterm WG1800HP2<ul><li><a href=https://www.aterm.jp/product/atermstation/product/warpstar/wg1800hp2/>https://www.aterm.jp/product/atermstation/product/warpstar/wg1800hp2/</a></li><li>2014/10/9　発売</li><li>現在はサポート終了済</li></ul></li></ul><h2 id=ガワ調査>ガワ調査</h2><ul><li>ルーターなのでLANポートがついている<ul><li>ここから接続できる？</li></ul></li><li>TCP/23でtelnetが動作中<ul><li>Google検索したところパスワードは公開されていなさそうだった</li><li>とりあえず時間の無駄そうなので別の方法で攻略する</li></ul></li><li>基盤チェック</li></ul><p><img src=./img/1.webp alt=基板俯瞰></p><ul><li>ルーターは<strong>Unix/Linux</strong>で動いていることが多い<ul><li>組み込みのUnix/Linux</li></ul></li><li>テスト用にUARTのポートがあることが多い<ul><li>見分け方<ul><li>4~5個のテストピンやテストパッドが基盤に実装されている</li></ul></li></ul></li></ul><blockquote><p>Tips: UARTについて</p><p>UART (Universal Asynchronous Receiver Transmitter)<br>最低3本の線でシリアル通信ができる通信規格<br>GNDなくても動くケースが多いが、ノイズ対策の観点から使うべき</p><ul><li>Tx: 送信</li><li>Rx: 受信</li><li>GND: 基準電圧
<img src=img/2.webp alt></li></ul></blockquote><blockquote><p><strong>クロックの指定が結線上に存在していないため、ボーレートをデバイス側で指定する必要がある</strong></p></blockquote><ul><li><p>基盤を眺めると怪しいテストポートがある
<img src=img/3.webp alt></p><ul><li>テストポートが5つの場合は以下のものが想定される<ul><li>VCC (3.3V or 5V)</li><li>GND</li><li>Rx</li><li>Tx</li><li>多目的使用 or N.C.</li></ul></li><li>テスターを利用して探していく</li></ul></li><li><p>各ポートの調査のコツ</p><ul><li>最初にVCCとGNDを探す<ul><li>テスターを利用して3.3V / 5Vを拾えたら残りをguessする</li></ul></li><li>Txのポートは伝送時に電圧がHighになる</li><li>Rxのポートは大きく動かない</li><li>スペクトラムアナライザがあると便利<ul><li>UARTの通信を拾うくらいならラズパイピコで作れるので作ることをオススメ<ul><li><a href=https://oscilloscope.fhdm.xyz/>https://oscilloscope.fhdm.xyz/</a></li></ul></li></ul></li></ul></li><li><p>調査の結果、こんな感じに
<img src=img/4.webp alt></p></li><li><p>ポートにはんだ付け
<img src=img/5.webp alt></p><ul><li>GNDのはんだがあまりにも汚い<ul><li>みんなはフラックスをちゃんと&mldr;使おうね！</li></ul></li></ul></li><li><p>BusPirateにTx, Rx, GNDを接続</p><ul><li>注意: Tx-Rx, Rx-Txとデバイス間でTx, Rxの接続は逆になる</li><li>なぜか手元のFTDIチップのシリアル変換ボードで動作しなかった<ul><li>いまだに理由がわかってない</li><li>家に転がってたBus Pirateで対応
<img src=img/6.webp alt></li></ul></li></ul></li></ul><h2 id=シェルアクセス>シェルアクセス</h2><ul><li><p>ターミナルを開いていろいろ見ていく</p><ul><li><img src=img/7.webp alt></li></ul></li><li><p>シェルのログイン画面が見えるが、ID/パスワードがわからない</p><ul><li>ブルートフォースは現実的ではない
<img src=img/8.webp alt></li></ul></li></ul><h2 id=root奪取>root奪取</h2><ul><li>シングルユーザーモードで立ち上げる必要がある<ul><li>ブートローダーであるUbootをどうにかする必要がある</li><li>ルーター起動中に<code>Ctrl-C</code>を連打することでシングルユーザーモードに入れる
<img src=./img/9.webp alt></li></ul></li></ul><h2 id=ファイルシステム探訪>ファイルシステム探訪</h2><ul><li><p>ルーターのWebアプリケーションして動作するCGIを発見</p><ul><li><img src=img/10.webp alt></li></ul></li><li><p>シングルユーザーモードなのでネットワーク環境がない</p><ul><li><p>どうやって持ち帰るか</p></li><li><p>USBが生えているのでこいつでUSBをマウントできるか試す
<img src=img/11.webp alt></p></li><li><p>USBメモリを刺すとマスストレージとして認識</p><ul><li>マウントしたら使えそう
<img src=img/12.webp alt></li></ul></li></ul></li><li><p>Mountコマンドがない
<img src=img/13.webp alt></p></li><li><p>使えそうなバイナリを調査</p><ul><li>mount_ffs</li><li>mount_kernfs</li><li>mount_msdos</li><li>mount_procfs</li><li>mount_tinyfs<ul><li>→ <code>mount_msdos</code>, <code>mount_tinyfs</code>が使えそう</li></ul></li></ul></li><li><p>USBを刺し、それをmsdosでフォーマット、mount_msdosでマウントする
<img src=img/14.webp alt></p><p><img src=img/15.webp alt></p></li><li><p>あとはddとかで好き勝手ファイルをコピーしまくるだけ</p><ul><li>お持ち帰りしたファイルを思う存分味わおう!
<img src=img/16.webp alt></li></ul></li></ul><h2 id=おわりに>おわりに</h2><p>この業界をひたすら走り続けている<a href=https://%E5%A4%A7%E7%A0%B4.net/>大破.net</a>氏に大いなる経緯を表します<br>本記事の一部では大破氏の過去記事を参考にさせていただきました<br>また、分解したwifiルーターの使用については法的な部分から怪しくなるので廃棄済みです<br>そもそも古いwifiルーターをおもちゃとしてメルカリで超格安で買ったので問題ないな！ヨシ！<br>暇があればハードウェアネタも書いていこうと思います</p></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/categories>Categories</a></li><li><a href=/tags>Tags</a></li><li><a href=/index.xml>Rss</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#攻略対象>攻略対象</a></li><li><a href=#ガワ調査>ガワ調査</a></li><li><a href=#シェルアクセス>シェルアクセス</a></li><li><a href=#root奪取>root奪取</a></li><li><a href=#ファイルシステム探訪>ファイルシステム探訪</a></li><li><a href=#おわりに>おわりに</a></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fxrzhev.com%2fposts%2f2024-08-17%2f&text=Aterm%20WG1800HP2%e3%81%aeroot%e3%82%92%e5%8f%96%e3%82%8b" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fxrzhev.com%2fposts%2f2024-08-17%2f&title=Aterm%20WG1800HP2%e3%81%aeroot%e3%82%92%e5%8f%96%e3%82%8b" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Aterm%20WG1800HP2%e3%81%aeroot%e3%82%92%e5%8f%96%e3%82%8b&body=Check out this article: https%3a%2f%2fxrzhev.com%2fposts%2f2024-08-17%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fxrzhev.com%2fposts%2f2024-08-17%2f&title=Aterm%20WG1800HP2%e3%81%aeroot%e3%82%92%e5%8f%96%e3%82%8b" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fxrzhev.com%2fposts%2f2024-08-17%2f&title=Aterm%20WG1800HP2%e3%81%aeroot%e3%82%92%e5%8f%96%e3%82%8b" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fxrzhev.com%2fposts%2f2024-08-17%2f&t=Aterm%20WG1800HP2%e3%81%aeroot%e3%82%92%e5%8f%96%e3%82%8b" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2025 xrzhev</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/categories>Categories</a></li><li><a href=/tags>Tags</a></li><li><a href=/index.xml>Rss</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script><script src=/js/code-copy.js></script></html>